$(document).ready(function(){ptmenu.initSortMenuItem()});var ptmenu={initSortMenuItem:function(){$(".top_sortable").sortable({placeholder:"ui-state-highlight ui-top-highlight",stop:function(){var e=0;$(".top_item_content").each(function(){$(this).find(".top-item-position").val(e),e++})}}),$(".second_sortable").sortable({placeholder:"ui-state-highlight ui-second-highlight",stop:function(){$(".top_item_content").each(function(){var e=0;$(this).find(".second_item_content").each(function(){$(this).find(".sub-item-position2").val(e),e++})})}}),$(".third_sortable").sortable({placeholder:"ui-state-highlight ui-third-highlight",stop:function(){$(".top_item_content").each(function(){$(this).find(".second_item_content").each(function(){var e=0;$(this).find(".third_item_content").each(function(){$(this).find(".sub-item-position3").val(e),e++})})})}}),$(".widget-sortable").sortable({placeholder:"widget-block ui-state-highlight",items:"> .widget-block",start:function(e,t){var i=t.item.find(".widget-cols").val();$(".ui-state-highlight").addClass("col-sm-"+i).html('<div class="widget-content"></div>'),$(".widget-block").removeClass("w-transition")},stop:function(e,t){var i=0;$(".widget-block").each(function(){$(this).find(".widget-position").val(i),i++})}})},appendTopItemNewForm:function(e){$.ajax({url:e,type:"get",beforeSend:function(){$("#form-container-bg").show(),$("#form-ajax-loader").show()},success:function(e){$("#form-container").html(e.html).show(600)}})},appendAddSubItemForm:function(e,t){var i=$("#sub-item-form-url").val();$.ajax({url:i+"&parent_id="+e+"&level="+t,type:"get",beforeSend:function(){$("#form-container-bg").show(),$("#form-ajax-loader").show()},success:function(e){$("#form-container").addClass("sub-frm").html(e.html).show(600)}})},appendEditSubItemForm:function(e){var t=$("#sub-item-edit-form-url").val();$.ajax({url:t+"&sub_item_id="+e,type:"get",beforeSend:function(){$("#form-container-bg").show(),$("#form-ajax-loader").show()},success:function(e){$("#form-container").addClass("sub-frm").html(e.html).show(600)}})},submitTopItemForm:function(e){var t=$("#form-menu-item").attr("action"),i=$("#text-success-item").val(),a=!0;$.ajax({url:t,type:"post",data:$("#form-menu-item").serialize(),beforeSend:function(){$("#form-container").html("").hide()},success:function(t){!0===t.submit?ptmenu.getItemsToContainer(e):(a=!1,$("#form-container-bg").show(),$("#form-ajax-loader").show(),$("#form-container").html(t.html).show(600))},complete:function(){$(".alert").remove(),a&&$(".panel-default").before('<div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> '+i+'\n<button type="button" class="close" data-dismiss="alert">&times;</button>\n</div>')}})},submitSubItemForm:function(e){var t=$("#form-menu-item").attr("action"),i=$("#text-success-item").val(),a=!0;$.ajax({url:t,type:"post",data:$("#form-menu-item").serialize(),beforeSend:function(){$("#form-container").removeClass("sub-frm").html("").hide()},success:function(t){!0===t.submit?ptmenu.getItemsToContainer(e):(a=!1,$("#form-container-bg").show(),$("#form-ajax-loader").show(),$("#form-container").addClass("sub-frm").html(t.html).show(600))},complete:function(){$(".alert").remove(),a&&$(".panel-default").before('<div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> '+i+'\n<button type="button" class="close" data-dismiss="alert">&times;</button>\n</div>')}})},deleteMenuItem:function(e){var t=$("#text-confirm-delete").val(),i=$("#text-success-item").val();if(confirm(t)){var a=!0;$.ajax({url:e,type:"get",beforeSend:function(){$("#form-container-bg").show(),$("#form-ajax-loader").show()},success:function(e){var t=e.menu_id;!0===e.result?ptmenu.getItemsToContainer(t):a=!1},complete:function(){$(".alert").remove(),a&&$(".panel-default").before('<div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> '+i+'\n<button type="button" class="close" data-dismiss="alert">&times;</button>\n</div>'),ptmenu.closeForm()}})}},deleteCheckItems:function(){var e=$("#text-confirm-multiple-delete").val(),t=$("#text-choose-delete").val(),i=$("#text-success-item").val(),a=!1,n=[],s=[];if($(".top-ck-del:checked").each(function(){a=!0,n.push($(this).val())}),$(".sub-ck-del:checked").each(function(){a=!0,s.push($(this).val())}),a){if(confirm(e)){var o=$("#multiple-del-url").val(),l=!0;$.ajax({url:o,type:"post",data:{top_items:n,sub_items:s},beforeSend:function(){$("#form-container-bg").show(),$("#form-ajax-loader").show()},success:function(e){var t=e.menu_id;!0===e.result?ptmenu.getItemsToContainer(t):l=!1},complete:function(){$(".alert").remove(),l&&$(".panel-default").before('<div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> '+i+'\n<button type="button" class="close" data-dismiss="alert">&times;</button>\n</div>'),ptmenu.closeForm()}})}}else alert(t)},getItemsToContainer:function(e){var t=$("#get-top-item-url").val()+"&menu_id="+e,a=$("#input-add-sub-item").val(),n=$("#text-no-items").val();$.ajax({url:t,type:"get",beforeSend:function(){$("#form-container-bg").show(),$("#form-ajax-loader").show()},success:function(e){var t=e.top_items,s=[],o="";if(t){o+='<div class="top_item_container top_sortable">';for(i in t){if(o+='<div class="top_item_content">',o+='<div class="top_item item row">',t[i].sub_items&&(o+='<a href="#second-content-'+i+'" data-toggle="collapse" class="parent collapsed expand"></a>'),o+=' <div class="del-name">',o+='<div class="del-action">',o+='<input type="checkbox" class="ck-del top-ck-del" value="'+t[i].menu_item_id+'" />',o+="</div>",o+='<div class="name"><span>'+t[i].name+"</span></div>",o+=" </div>",o+=' <div class="action">',o+='<a href="javascript:void(0)" title="'+a+'" onclick="ptmenu.appendAddSubItemForm(\''+t[i].menu_item_id+'\', \'2\')" class="a-config"><i class="fa fa-plus"></i></a>',o+='<a href="javascript:void(0)" onclick="ptmenu.appendTopItemNewForm(\''+t[i].url+'\')" class="a-config"><i class="fa fa-pencil"></i></a>',o+='<a href="javascript:void(0)" onclick="ptmenu.deleteMenuItem(\''+t[i].del_url+'\')" class="a-delete a-config"><i class="fa fa-times"></i></a>',o+=" </div>",o+="</div>",t[i].sub_items){s=t[i].sub_items,o+='<div class="second_item_container second_sortable collapse" id="second-content-'+i+'">';for(j in s){if(o+='<div class="second_item_content">',o+='<div class="second_item item row">',s[j].sub_items&&(o+='<a href="#third-content-'+i+"-"+j+'" data-toggle="collapse" class="parent collapsed expand"></a>'),o+=' <div class="del-name">',o+='<div class="del-action">',o+='<input type="checkbox" class="ck-del sub-ck-del" value="'+s[j].item_id+'" />',o+="</div>",o+='<div class="name"><span>'+s[j].name+"</span></div>",o+=" </div>",o+=' <div class="action">',o+='<a href="javascript:void(0)" title="'+a+'" onclick="ptmenu.appendAddSubItemForm(\''+s[j].item_id+'\', \'3\')" class="a-config"><i class="fa fa-plus"></i></a>',o+='<a href="javascript:void(0)" onclick="ptmenu.appendEditSubItemForm(\''+s[j].item_id+'\')" class="a-config"><i class="fa fa-pencil"></i></a>',o+='<a href="javascript:void(0)" onclick="ptmenu.deleteMenuItem(\''+s[j].del_url+'\')" class="a-delete a-config"><i class="fa fa-times"></i></a>',o+=" </div>",o+="</div>",s[j].sub_items){s_items=s[j].sub_items,o+='<div class="third_item_container third_sortable collapse" id="third-content-'+i+"-"+j+'">';for(k in s_items)o+='<div class="third_item_content">',o+='<div class="third_item item row">',o+=' <div class="del-name">',o+='<div class="del-action">',o+='<input type="checkbox" class="ck-del sub-ck-del" value="'+s_items[k].item_id+'" />',o+="</div>",o+='<div class="name"><span>'+s_items[k].name+"</span></div>",o+=" </div>",o+=' <div class="action">',o+='<a href="javascript:void(0)" onclick="ptmenu.appendEditSubItemForm(\''+s_items[k].item_id+'\')" class="a-config"><i class="fa fa-pencil"></i></a>',o+='<a href="javascript:void(0)" onclick="ptmenu.deleteMenuItem(\''+s_items[k].del_url+'\')" class="a-delete a-config"><i class="fa fa-times"></i></a>',o+=" </div>",o+="</div>",o+='<input type="hidden" class="sub-item-position3" name="sub_item_position3['+s_items[k].item_id+']" value="'+s_items[k].position+'"/>',o+="</div>";o+="</div>"}o+='<input type="hidden" class="sub-item-position2" name="sub_item_position2['+s[j].item_id+']" value="'+s[j].position+'"/>',o+="</div>"}o+="</div>"}o+='<input type="hidden" class="top-item-position" name="top_item_position['+t[i].menu_item_id+']" value="'+t[i].position+'"/>',o+="</div>"}o+="</div>"}else o+='<p class="text-center">'+n+"</p>";$(".menu_item_container").html(o)},complete:function(){ptmenu.initSortMenuItem(),ptmenu.closeForm()}})},addCategoryWidget:function(){var e=$("#input-sub-menu-category").val(),t=$("#text-show-image").val(),a=$("#text-show-child").val(),n=$("#text-no-children-items").val(),s=$("#input-append-categories-link").val()+"&category_id="+e,o="";$.ajax({url:s,type:"get",beforeSend:function(){$("#widget-type-category-container .p-widget-items").remove(),$(".frm-loader-img").show()},success:function(s){$("#widget-type-category-container").html("");var l=s.child_categories;if(l){for(i in l)o+='<div class="widget-block col-sm-2">',o+='<div class="widget-content">',o+=' <a class="a-resize-minus a-left" onclick="ptmenu.decreaseColumn($(this))"><i class="fa fa-chevron-left" aria-hidden="true"></i></a>',o+=' <a class="a-resize-plus a-left" onclick="ptmenu.increaseColumn($(this))"><i class="fa fa-chevron-right" aria-hidden="true"></i></a>',o+=' <div class="widget-name-container">',o+='<span class="name">'+l[i].name+"</span>",o+=" </div>",o+=' <div class="widget-action">',o+='<a class="a-config" onclick="ptmenu.showWidgetConfiguration($(this))"><i class="fa fa-pencil" aria-hidden="true"></i></a>',o+='<a class="a-delete a-config" onclick="ptmenu.deleteWidget($(this))"><i class="fa fa-times" aria-hidden="true"></i></a>',o+=" </div>",o+="</div>",o+='<div class="widget-configuration">',o+=' <div><input type="checkbox" class="show-image" /> '+t+"</div>",o+=' <div><input type="checkbox" class="show-child" /> '+a+"</div>",o+="</div>",o+='<input type="hidden" class="widget-name" value="'+l[i].name+'" name="widget[category]['+i+'][name]" />',o+='<input type="hidden" class="widget-type" value="category" name="widget[category]['+i+'][type]" />',o+='<input type="hidden" class="widget-cols" value="2" name="widget[category]['+i+'][cols]" />',o+='<input type="hidden" class="widget-position" value="'+i+'" name="widget[category]['+i+'][position]" />',o+='<input type="hidden" class="widget-category-id" value="'+l[i].category_id+'" name="widget[category]['+i+'][category_id]" />',o+='<input type="hidden" class="widget-show-image" value="0" name="widget[category]['+i+'][show_image]" />',o+='<input type="hidden" class="widget-show-child" value="0" name="widget[category]['+i+'][show_child]" />',o+="</div>";$("#input-has-child").val("1"),$("#widget-type-category-container").html(o)}else $("#input-has-child").val("0"),$("#widget-type-category-container").html('<p class="p-widget-items">'+n+"</p>");$("#input-link").val(s.category_link),$(".link-selection").val("0"),$("#input-category-id").val(e)},complete:function(){$(".frm-loader-img").hide(),ptmenu.checkBoxClick(),ptmenu.initSortMenuItem()}})},addWidget:function(){var e=$("#text-user-token").val(),t=$("#widget-type").val(),i=$("#widget-cols").val(),a=$("#input-sub-menu-content-type").val(),n=$("#text-show-image").val(),s=$("#text-show-child").val(),o=$("#text-choose-category").val(),l=$("#text-choose-product").val(),c=$("#text-title").val(),d=$("#text-link").val(),u=$("#text-html").val(),r=$("#text-hide-title").val(),m=$(".widget-block").length;null===m&&(m=0),$("#widget-type-"+a+"-container .p-widget-items").hide();var g="";g+='<div class="widget-block col-sm-'+i+'">',g+='<div class="widget-content">',g+=' <a class="a-resize-minus a-left" onclick="ptmenu.decreaseColumn($(this))"><i class="fa fa-chevron-left" aria-hidden="true"></i></a>',g+=' <a class="a-resize-plus a-left" onclick="ptmenu.increaseColumn($(this))"><i class="fa fa-chevron-right" aria-hidden="true"></i></a>',g+=' <div class="widget-name-container">',g+='<span class="name">...</span>',g+=" </div>",g+=' <div class="widget-action">',g+='<a class="a-config" onclick="ptmenu.showWidgetConfiguration($(this))"><i class="fa fa-pencil" aria-hidden="true"></i></a>',g+='<a class="a-delete a-config" onclick="ptmenu.deleteWidget($(this))"><i class="fa fa-times" aria-hidden="true"></i></a>',g+=" </div>",g+="</div>","category"==t&&(g+='<div class="widget-configuration">',g+='<div class="option"><input type="text" class="w-category" placeholder="'+o+'" /></div>',g+='<div class="option"><input type="checkbox" class="show-image" /> '+n+"</div>",g+='<div class="option"><input type="checkbox" class="show-child" /> '+s+"</div>",g+="</div>",g+='<input type="hidden" class="widget-name" value="" name="widget['+a+"]["+m+'][name]" />'),"product"==t&&(g+='<div class="widget-configuration">',g+='<div class="option"><input type="text" class="w-product" placeholder="'+l+'" /></div>',g+='<div class="option"><input type="checkbox" class="show-image" /> '+n+"</div>",g+="</div>",g+='<input type="hidden" class="widget-name" value="" name="widget['+a+"]["+m+'][name]" />'),"html"==t&&(g+='<div class="widget-configuration">',g+='<ul class="nav nav-tabs ul-widget-lang" id="ul-widget-html-'+m+'">',g+="</ul>",g+='<div class="tab-content" id="tab-widget-html-'+m+'">',g+="</div>",g+='<div class="option"><input type="checkbox" class="show-title" /> '+r+"</div>",g+="</div>",$.ajax({url:"index.php?route=plaza/ultimatemenu/getLanguageData&user_token="+e,type:"get",success:function(e){$.each(e.languages,function(e,t){$("#ul-widget-html-"+m).append('<li><a href="#widget-html-language'+t.language_id+"-"+m+'" data-toggle="tab"><img src="language/'+t.code+"/"+t.code+'.png" title="'+t.name+'" /> '+t.name+"</a></li>");var i="";i+='<div class="tab-pane" id="widget-html-language'+t.language_id+"-"+m+'">',i+='<div class="option"><input type="text" name="widget['+a+"]["+m+"][name]["+t.language_id+']" placeholder="'+c+'" /></div>',i+='<div class="option">',i+=' <textarea data-toggle="summernote" rows="10" class="w-html-content" name="widget['+a+"]["+m+"][content]["+t.language_id+']" placeholder="'+u+'"></textarea>',i+="</div>",i+="</div>",$("#tab-widget-html-"+m).append(i)})},complete:function(){$("#ul-widget-html-"+m+" a:first").tab("show"),ptmenu.initSortMenuItem(),ptmenu.initSummerNote(),ptmenu.checkBoxClick()}})),"link"==t&&(g+='<div class="widget-configuration">',g+='<ul class="nav nav-tabs ul-widget-lang" id="ul-widget-link-'+m+'">',g+="</ul>",g+='<div class="tab-content" id="tab-widget-link-'+m+'">',g+="</div>",g+='<div class="option"><input type="text" name="widget['+a+"]["+m+'][link]" placeholder="'+d+'" /></div>',g+="</div>",$.ajax({url:"index.php?route=plaza/ultimatemenu/getLanguageData&user_token="+e,type:"get",success:function(e){$.each(e.languages,function(e,t){$("#ul-widget-link-"+m).append('<li><a href="#widget-link-language'+t.language_id+"-"+m+'" data-toggle="tab"><img src="language/'+t.code+"/"+t.code+'.png" title="'+t.name+'" /> '+t.name+"</a></li>");var i="";i+='<div class="tab-pane" id="widget-link-language'+t.language_id+"-"+m+'">',i+='<div class="option"><input type="text" name="widget['+a+"]["+m+"][name]["+t.language_id+']" placeholder="'+c+'" /></div>',i+="</div>",$("#tab-widget-link-"+m).append(i)})},complete:function(){$("#ul-widget-link-"+m+" a:first").tab("show"),ptmenu.initSortMenuItem(),ptmenu.checkBoxClick()}})),g+='<input type="hidden" class="widget-type" value="'+t+'" name="widget['+a+"]["+m+'][type]" />',g+='<input type="hidden" class="widget-cols" value="'+i+'" name="widget['+a+"]["+m+'][cols]" />',g+='<input type="hidden" class="widget-position" value="'+m+'" name="widget['+a+"]["+m+'][position]" />',"category"==t&&(g+='<input type="hidden" class="widget-category-id" value="" name="widget['+a+"]["+m+'][category_id]" />',g+='<input type="hidden" class="widget-show-image" value="0" name="widget['+a+"]["+m+'][show_image]" />',g+='<input type="hidden" class="widget-show-child" value="0" name="widget['+a+"]["+m+'][show_child]" />'),"product"==t&&(g+='<input type="hidden" class="widget-product-id" value="" name="widget['+a+"]["+m+'][product_id]" />',g+='<input type="hidden" class="widget-show-image" value="0" name="widget['+a+"]["+m+'][show_image]" />'),"html"==t&&(g+='<input type="hidden" class="widget-show-title" value="1" name="widget['+a+"]["+m+'][show_title]" />'),g+="</div>",$("#input-has-child").val("1"),$("#widget-type-"+a+"-container").append(g),ptmenu.initSortMenuItem(),ptmenu.chooseCategory(),ptmenu.chooseProduct(),ptmenu.initSummerNote(),ptmenu.checkBoxClick()},deleteWidget:function(e){e.closest(".widget-block").remove();var t=0;$(".widget-block").each(function(){$(this).find(".widget-position").val(t),t++})},increaseColumn:function(e){var t=parseInt(e.closest(".widget-block").find(".widget-cols").val());t<12&&(t+=1,e.closest(".widget-block").find(".widget-cols").val(t),e.closest(".widget-block").removeClass().addClass("widget-block").addClass("w-transition").addClass("col-sm-"+t)),ptmenu.initSortMenuItem()},decreaseColumn:function(e){var t=e.closest(".widget-block").find(".widget-cols").val();t>2&&(t-=1,e.closest(".widget-block").find(".widget-cols").val(t),e.closest(".widget-block").removeClass().addClass("widget-block").addClass("w-transition").addClass("col-sm-"+t)),ptmenu.initSortMenuItem()},showWidgetConfiguration:function(e){var t=e.closest(".widget-block").find(".widget-configuration");t.hasClass("active")?(t.removeClass("active"),$(".widget-sortable").sortable("enable")):($(".widget-sortable").sortable("disable"),$(".widget-configuration").removeClass("active"),t.addClass("active"))},closeForm:function(){$("#form-container-bg").hide(),$("#form-ajax-loader").hide(),$("#form-container").removeClass("sub-frm").html("").hide()},chooseCategory:function(){var e=$("#text-user-token").val();$(".w-category").customAutoComplete({source:function(t,i){$.ajax({url:"index.php?route=plaza/ultimatemenu/autoCompleteCategory&user_token="+e+"&filter_name="+encodeURIComponent(t),dataType:"json",success:function(e){i($.map(e,function(e){return{label:e.name,value:e.category_id}}))}})},select:function(e){$(this).val(e.label),$(this).closest(".widget-block").find(".widget-category-id").val(e.value),$(this).closest(".widget-block").find(".widget-name").val(e.label),$(this).closest(".widget-block").find(".widget-content").find(".widget-name-container").find(".name").html(e.label)}})},chooseProduct:function(){var e=$("#text-user-token").val();$(".w-product").customAutoComplete({source:function(t,i){$.ajax({url:"index.php?route=catalog/product/autocomplete&user_token="+e+"&filter_name="+encodeURIComponent(t),dataType:"json",success:function(e){i($.map(e,function(e){return{label:e.name,value:e.product_id}}))}})},select:function(e){$(this).val(e.label),$(this).closest(".widget-block").find(".widget-product-id").val(e.value),$(this).closest(".widget-block").find(".widget-name").val(e.label),$(this).closest(".widget-block").find(".widget-content").find(".widget-name-container").find(".name").html(e.label)}})},checkBoxClick:function(){$(".show-image").change(function(){"1"==$(this).closest(".widget-block").find(".widget-show-image").val()?$(this).closest(".widget-block").find(".widget-show-image").val("0"):$(this).closest(".widget-block").find(".widget-show-image").val("1")}),$(".show-child").change(function(){"1"==$(this).closest(".widget-block").find(".widget-show-child").val()?$(this).closest(".widget-block").find(".widget-show-child").val("0"):$(this).closest(".widget-block").find(".widget-show-child").val("1")}),$(".show-title").change(function(){"1"==$(this).closest(".widget-block").find(".widget-show-title").val()?$(this).closest(".widget-block").find(".widget-show-title").val("0"):$(this).closest(".widget-block").find(".widget-show-title").val("1")})},initSummerNote:function(){$("[data-toggle='summernote']").each(function(){var e=this;$(this).attr("data-lang")&&$("head").append('<script type="text/javascript" src="view/javascript/summernote/lang/summernote-'+$(this).attr("data-lang")+'.js"><\/script>'),$(e).summernote({lang:$(this).attr("data-lang"),disableDragAndDrop:!0,height:300,emptyPara:"",codemirror:{mode:"text/html",htmlMode:!0,lineNumbers:!0,theme:"monokai"},fontsize:["8","9","10","11","12","14","16","18","20","24","30","36","48","64"],toolbar:[["font",["bold","underline","italic"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol"]],["insert",["link","image"]],["view",["codeview"]]],popover:{image:[["custom",["imageAttributes"]],["imagesize",["imageSize100","imageSize50","imageSize25"]],["float",["floatLeft","floatRight","floatNone"]],["remove",["removeMedia"]]]},buttons:{image:function(){return $.summernote.ui.button({contents:'<i class="note-icon-picture" />',tooltip:$.summernote.lang[$.summernote.options.lang].image.image,click:function(){$("#modal-image").remove(),$.ajax({url:"index.php?route=common/filemanager&user_token="+getURLVar("user_token"),dataType:"html",beforeSend:function(){$("#button-image i").replaceWith('<i class="fa fa-circle-o-notch fa-spin"></i>'),$("#button-image").prop("disabled",!0)},complete:function(){$("#button-image i").replaceWith('<i class="fa fa-upload"></i>'),$("#button-image").prop("disabled",!1)},success:function(t){$("body").append('<div id="modal-image" class="modal">'+t+"</div>"),$("#modal-image").modal("show"),$("#modal-image").delegate("a.thumbnail","click",function(t){t.preventDefault(),$(e).summernote("insertImage",$(this).attr("href")),$("#modal-image").modal("hide")})}})}}).render()}}})})}};!function(e){e.fn.customAutoComplete=function(t){return this.each(function(){var i=e(this),a=e('<ul class="dropdown-menu" />');this.timer=null,this.items=[],e.extend(this,t),i.attr("autocomplete","off"),i.on("focus",function(){this.request()}),i.on("blur",function(){setTimeout(function(e){e.hide()},200,this)}),i.on("keydown",function(e){switch(e.keyCode){case 27:this.hide();break;default:this.request()}}),this.click=function(t){t.preventDefault();var i=e(t.target).parent().attr("data-value");i&&this.items[i]&&this.select(this.items[i])},this.show=function(){var e=i.position();a.css({top:e.top+i.outerHeight(),left:e.left}),a.show()},this.hide=function(){a.hide()},this.request=function(){clearTimeout(this.timer),this.timer=setTimeout(function(t){t.source(e(t).val(),e.proxy(t.response,t))},200,this)},this.response=function(e){var t,i="",n={},s=0,o=0;if(e.length){for(s=0;s<e.length;s++)this.items[e[s].value]=e[s],e[s].category?(n[t=e[s].category]||(n[t]=[]),n[t].push(e[s])):i+='<li data-value="'+e[s].value+'"><a href="#">'+e[s].label+"</a></li>";for(t in n)for(i+='<li class="dropdown-header">'+t+"</li>",o=0;o<n[t].length;o++)i+='<li data-value="'+n[t][o].value+'"><a href="#">&nbsp;&nbsp;&nbsp;'+n[t][o].label+"</a></li>"}i?this.show():this.hide(),a.html(i)},a.on("click","> li > a",e.proxy(this.click,this)),i.after(a)})}}(window.jQuery);